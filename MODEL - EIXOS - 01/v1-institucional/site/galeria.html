<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galeria - Instituto Eixos</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Styles -->
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/css/theme-test.css" id="theme-test" />
</head>
<body>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <a href="index.html" class="header-seal-logo">
                <span class="logo-menu-label">MENU</span>
                <img src="assets/img/instituto-eixos-logo.png" alt="Selo Instituto Eixos">
            </a>
            
            <a href="editais.html" class="mobile-quick-link">
                Transparência
            </a>
            
            <nav class="nav-menu">
                <a href="index.html" class="nav-link">Início</a>
                <a href="quem-somos.html" class="nav-link">Quem Somos</a>
                <a href="projetos.html" class="nav-link">
                    Projetos
                    <span class="mobile-desc">Nossas iniciativas</span>
                </a>
                <a href="galeria.html" class="nav-link active">Galeria</a>
                <a href="editais.html" class="nav-link">
                    Transparência
                    <span class="mobile-desc">Editais e contas</span>
                </a>
                <a href="noticias.html" class="nav-link">Notícias</a>
                <a href="doe-aqui.html" class="nav-link btn btn-outline btn-sm">Doe Aqui</a>
                <a href="fale-conosco.html" class="nav-link btn btn-primary text-white btn-sm">Fale Conosco</a>
            </nav>
            

        </div>
    </header>

    <!-- Page Header -->
    <header class="page-header">
        <div class="page-header-bg" style="background-image: url('assets/img/gallery-hero.png');"></div>
        <div class="container page-header-content">
            <h1>Galeria de Fotos</h1>
            <p>Registros de nossos momentos e ações.</p>
        </div>
    </header>

    <!-- Gallery Grid (Masonry) -->
    <section style="padding: 6rem 0;">
        <div class="container">
            <!-- Filter/Tabs (Optional Visual) -->
            <div class="text-center mb-5 reveal">
                <span class="tag tag-primary">Nossos Momentos</span>
                <h2 class="section-title center">Galeria de Impacto</h2>
                <p>Veja como estamos transformando vidas na prática.</p>
            </div>

            <!-- Gallery Grid Container -->
            <div class="gallery-masonry">
                <!-- Javascript will inject images here -->
            </div>
        </div>
    </section>  

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col" style="max-width: 300px;">
                    <img src="assets/img/instituto-eixos-logo.png" alt="Logo" class="footer-logo">
                    <p style="opacity: 0.7;">Transformando a realidade de milhares de brasileiros através da solidariedade e ação social.</p>
                    <div class="social-links-gap">
                        <a href="https://www.instagram.com/institutoeixos/" class="social-icon-lg" target="_blank"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-icon-lg"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="social-icon-lg"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4>Mapa do Site</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">Início</a></li>
                        <li><a href="quem-somos.html">Quem Somos</a></li>
                        <li><a href="projetos.html">Projetos</a></li>
                        <li><a href="noticias.html">Notícias</a></li>
                        <li><a href="#transparencia">Transparência</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Contato</h4>
                    <ul class="footer-contact">
                        <li><i class="fas fa-map-marker-alt"></i> <span>Taguatinga Norte, Brasília/DF<br>Q CNC 3, Bloco B, Sala 611</span></li>
                        <li><i class="fas fa-envelope"></i> <span>contato@institutoeixos.org.br</span></li>
                        <li><i class="fab fa-whatsapp"></i> <span>(61) 98103-0472</span></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 Instituto Eixos. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="assets/js/script.js"></script>
    <!-- Firebase & Dynamic Content -->
    <script type="module" src="../admin/assets/js/firebase-config.js" id="firebase-init"></script>
    <script type="module">
        import { db } from '../admin/assets/js/firebase-config.js';
        import { collection, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const galleryMasonry = document.querySelector('.gallery-masonry');
        let galleryData = [];

        if (galleryMasonry) {
            const q = query(collection(db, "galeria"), orderBy("createdAt", "desc"));
            
            onSnapshot(q, (snapshot) => {
                if (snapshot.empty) {
                    galleryMasonry.innerHTML = '<p class="text-center w-100 py-5 text-muted">A galeria será atualizada em breve.</p>';
                    return;
                }

                galleryMasonry.innerHTML = '';
                galleryData = []; // Reset

                snapshot.forEach((docSnap) => {
                    const data = docSnap.data();
                    const imageUrl = (data.imageUrl || '').replace('../', '');
                    
                    // Add to data array for Lightbox navigation
                    galleryData.push({
                        src: imageUrl,
                        title: data.title || data.name || 'Galeria',
                        caption: data.description || (data.createdAt ? new Date(data.createdAt).toLocaleDateString() : '')
                    });

                    // Create DOM Element
                    const item = document.createElement('div');
                    item.className = 'gallery-item';
                    item.innerHTML = `
                        <img src="${imageUrl}" alt="${data.title || 'Foto'}" loading="lazy">
                        <div class="gallery-overlay">
                            <h4>${data.title || 'Galeria'}</h4>
                            <p>${data.description || (data.createdAt ? new Date(data.createdAt).toLocaleDateString('pt-BR') : '')}</p>
                        </div>
                        <div class="gallery-icon-center">
                            <i class="fas fa-search-plus fa-lg"></i>
                        </div>
                    `;
                    
                    // Attach Click with Index
                    const currentIndex = galleryData.length - 1; // 0-based
                    item.onclick = () => {
                         if (window.openLightbox) {
                             window.openLightbox(currentIndex, galleryData);
                         }
                    };

                    galleryMasonry.appendChild(item);
                });
            });
        }
    </script>
</body>
</html>
